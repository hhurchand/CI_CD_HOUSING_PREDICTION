# -*- coding: utf-8 -*-
"""boston_CI_CD.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1XE0LvV5DuP8r5sLWo6kiC636Pz3fR94R
"""

import pandas as pd
import numpy as np

from sklearn import datasets
boston = datasets.load_boston()
X = boston.data
Y = boston.target

columns = boston.feature_names
boston_df = pd.DataFrame(boston.data)
boston_df.columns = columns
boston_df.head()

# study correlations
df_corr = boston_df.corr()

import matplotlib.pyplot as plt
import seaborn as sns
ax,fig = plt.subplots(1,1,figsize=(10,10))
sns.heatmap(df_corr,annot=True)

plt.savefig("heatmap.png",dpi=120)

from sklearn.preprocessing import StandardScaler

sc = StandardScaler()
df_X = sc.fit_transform(boston_df)

from sklearn.model_selection import train_test_split
X_train,X_test,y_train,y_test = train_test_split(df_X,Y,test_size=0.3,shuffle=True)

print(X_train.shape,y_train.shape)

print(X_test.shape,y_test.shape)

from sklearn.linear_model import LinearRegression

lr = LinearRegression()
lr.fit(X_train,y_train)

from sklearn.metrics  import r2_score
coef_det = r2_score(lr.predict(X_test),y_test)

with open("metrics.txt","w") as outfile:
    outfile.write("Coefficient of determination {} %".format(round(coef_det*100,2)))

#!pip freeze > requirements.txt

